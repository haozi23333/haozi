---
slug: 2019/11/19/ä¸€äº›typescriptæŠ€å·§
title: ä¸€äº›typescriptæŠ€å·§
authors: haozi
tags: [ç¬”è®°]
date: 2019-11-19 12:17:20
---



# ä¸€äº›typescriptæŠ€å·§

ç”¨äº† TS ä¹Ÿ2å¹´å¤šäº†, æŠŠé‡åˆ°çš„ä¸€äº› TS çš„é—®é¢˜ä»¥åŠè§£å†³æ–¹æ¡ˆç½—ä¸€ä¸‹

> æœ‰ç¡®è¯´å® ä¹Ÿå°±æ˜¯æ–‡æ¡£çœ‹å°‘äº† [è§å¼•ç”¨èµ„æ–™](#å¼•ç”¨èµ„æ–™)

å¤šçœ‹ä¸€ä¸‹ `typescript` çš„æºç , ä»¥åŠå„å¤§æµè¡Œæ¡†æ¶çš„æºç , å¯ä»¥å­¦åˆ°å¾ˆå¤šçŸ¥è¯†

<!--truncate-->

## Any

æ¯•ç«Ÿ <span style="font-size:2rem;color: #294E80"><span style="color: red">Any</span>Script</span>

æ²¡å•¥å¥½è¯´çš„ `any as any`



## ä¸€äº›æ–°ç‰¹æ€§

### Optional chaining

> TS 3.7.2 ç‰ˆæœ¬æ–°å¢ [è¯¦ç»†è¯´æ˜](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#optional-chaining)

è¿™ç©æ„å¾ˆå¤šè¯­è¨€éƒ½æœ‰äº†,  å°±æ˜¯è®©ä½ å°‘å†™ä¸€äº› `if` / `&&`

```typescript
let x = foo?.bar.baz();
â†“
let x = (foo === null || foo === undefined) ?
    undefined :
    foo.bar.baz();
```

### Nullish Coalescing

> TS 3.7.2 ç‰ˆæœ¬æ–°å¢ [è¯¦ç»†è¯´æ˜](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#nullish-coalescing)

å°±æ£€æŸ¥é»˜è®¤å€¼æ˜¯å¦å­˜åœ¨, å®˜æ–¹ä¾‹å­

```typescript
let x = foo ?? bar();
â†“
let x = (foo !== null && foo !== undefined) ?
    foo :
    bar();
```

å®é™…ä½œç”¨å°±æ˜¯ä»£æ›¿æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„ `||`, é¿å…ä¸€äº›ä¸å¯é¢„æœŸçš„é”™è¯¯ æ¯”å¦‚ `0`,`""(ç©ºå­—ç¬¦ä¸²`

```typescript
function Foo(name: string | null) {
   // this.name = this.name || "default";
    this.name = this.name ?? "default"
}
```

## ä» JSONç”ŸæˆTypescriptå®šä¹‰

æˆ‘ä¸€èˆ¬ä½¿ç”¨çš„ æ˜¯ è¿™ä¸ª[Json2Ts](http://json2ts.com/)

## å…³äºå¯¹è±¡

### MapLike

```typescript
interface MapLike<T> {
    [index: string]: T;
}
```

æ¯”å¦‚ä½ å®šä¹‰äº†ä¸€ä¸ª Object ä½†æ˜¯æ²¡å®šä¹‰ type æƒ³æ“ä½œé‡Œé¢çš„ä¸œè¥¿, ä½†æ˜¯æç¤º Key å¿…é¡»æ˜¯ `unique symbols`çš„æ—¶å€™



å¦‚æœç»™å®šäº† Object çš„ keys åˆ—è¡¨

```typescript
type usernames = "haozi" | "haozi2"

type IUser<T> = {
    [index in usernames]: T
}
```



å¦‚æœç»™å®šçš„æ˜¯ ä¸€ä¸ª `class `,  `interface`



```typescript
type A<T> = {
    [index in keyof ITest]: T;
};
```

* typeof - è·å–å˜é‡çš„ç±»å‹
* keyof - è·å–ç±»å‹çš„é”®
* in - éå†é”®å

ä»¥ä¸Šä¸‰ä¸ªå¯ä»¥ç»„åˆä½¿ç”¨

## ç±»å‹æ£€æŸ¥

å‡½æ•°å…¥å‚å¢åŠ ç±»å‹æ£€æŸ¥, ä¿è¯ `a`çš„è¯»å–å†™å…¥å®‰å…¨

```typescript
class Test {
	a: string 
    
    get_prototype<T extends keyof Test>(key: T): Test[T] {
        return this[key];
    }
    set_prototype<T extends keyof Test>(key: T, value: Test[T]): this {
        (this as Test)[key] = value;
        return this;
    }
}
```

## never

è¿™å±æ€§ç”¨åˆ°çš„è›®å°‘çš„, æ¯”å¦‚ä¸€ä¸ªå‡½æ•°æ°¸è¿œä¸ä¼šè¿”å›å€¼, æ¯”å¦‚ `renderLoop`

```typescript
// Function returning never must have unreachable end point
function error(message: string): never {
    throw new Error(message);
}

// Inferred return type is never
function fail() {
    return error("Something failed");
}

// Function returning never must have unreachable end point
function infiniteLoop(): never {
    while (true) {
    }
}
```



## å·¥å…·å±æ€§

æ²¡å•¥å¥½è¯´çš„ [æ–‡æ¡£](https://www.typescriptlang.org/docs/handbook/utility-types.html),(ç‚¹å‡»å‡½æ•°åä¹Ÿå¯ä»¥è·³è½¬)

* [`Partial<T>`](https://www.typescriptlang.org/docs/handbook/utility-types.html#partialt),  å°† `T` é‡Œé¢æ‰€ä»¥çš„å±æ€§å˜ä¸ºå¯é€‰å±æ€§

* [`Readonly<T>`](https://www.typescriptlang.org/docs/handbook/utility-types.html#readonlyt) å°† `T` é‡Œé¢æ‰€ä»¥çš„å±æ€§å˜ä¸ºåªè¯»å±æ€§

* [`Record<K,T>`](https://www.typescriptlang.org/docs/handbook/utility-types.html#recordkt) æ„é€ ä¸€ä¸ªç±»å‹ä¸º`T`å±æ€§ä¸ºKçš„ç±»å‹, ç±»ä¼¼



```typescript
interface F<K,T> {
    [index in T]: K
}
```


* [`Pick<T,K>`](https://www.typescriptlang.org/docs/handbook/utility-types.html#picktk) ä» `T` é‡Œé¢é€‰æ‹© `K`çš„æˆå‘˜ æ¥ç»„æˆä¸€ä¸ªæ–°çš„å±æ€§

* [`Omit<T,K>`](https://www.typescriptlang.org/docs/handbook/utility-types.html#omittk) å’Œ `Pick` ç›¸å,  ä» `T`é‡Œé¢æ’é™¤`K`çš„æˆå‘˜æ¥ç»„æˆæ–°çš„å±æ€§ 

* [`Exclude<T,U>`](https://www.typescriptlang.org/docs/handbook/utility-types.html#excludetu)å–`T`,`U`ä¸¤ä¸ªå…ƒç´ çš„

* [`Extract<T,U>`](https://www.typescriptlang.org/docs/handbook/utility-types.html#extracttu) å–`T`,`U`çš„æˆå‘˜å¹¶é›†

* [`NonNullable<T>`](https://www.typescriptlang.org/docs/handbook/utility-types.html#nonnullablet) æ’é™¤ `T` ä¸­çš„æ‰€æœ‰ `null`, `undefine`

* [`ReturnType<T>`](https://www.typescriptlang.org/docs/handbook/utility-types.html#returntypet) ç”±å‡½æ•°ç±»å‹`T`çš„è¿”å›å€¼ç±»å‹æ„é€ ä¸€ä¸ªç±»å‹ã€‚

* [`InstanceType<T>`](https://www.typescriptlang.org/docs/handbook/utility-types.html#instancetypet)ç”±æ„é€ å‡½æ•°ç±»å‹`T`çš„å®ä¾‹ç±»å‹æ„é€ ä¸€ä¸ªç±»å‹ã€‚

* [`Required<T>`](https://www.typescriptlang.org/docs/handbook/utility-types.html#requiredt) å°†`T`æˆå‘˜æ”¹ä¸º `required`

* [`ThisType<T>`](https://www.typescriptlang.org/docs/handbook/utility-types.html#thistypet)è¿™ä¸ªå·¥å…·ä¸ä¼šè¿”å›ä¸€ä¸ªè½¬æ¢åçš„ç±»å‹ã€‚å®ƒåšä¸ºä¸Šä¸‹æ–‡çš„`this`ç±»å‹çš„ä¸€ä¸ªæ ‡è®°ã€‚æ³¨æ„ï¼Œè‹¥æƒ³ä½¿ç”¨æ­¤ç±»å‹ï¼Œå¿…é¡»å¯ç”¨`--noImplicitThis`ã€‚



## ä¸æ”¯æŒ Emoji çš„è¯­è¨€æ˜¯å±‘

```typescript
const ğŸŒ¶ï¸ğŸ’¦ğŸ’‰ğŸ’§ğŸ‚ğŸº true
const ğŸ‘´ğŸ‘€â‘§â­ï¸ false
const ğŸœ main
const ğŸ”¢ int
const ğŸ”  char
```

## IOC å®¹å™¨

// TODO

## å‰©ä¸‹çš„é—®é¢˜æŒç»­æ”¶é›†ä¸­

// TODO

## å¼•ç”¨èµ„æ–™

[1]: Typescript Documentation https://www.typescriptlang.org/docs/home.html

[2]: TypeScript Deep Dive https://basarat.gitbooks.io/typescript/
